<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu - Pizza Party</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <nav class="navbar">
        <div class="container">
            <a href="index.html" class="logo">
                <img src="assets/images/logo.png" alt="Pizza Party Logo">
                <span>Pizza Party</span>
            </a>
            <div class="menu-toggle" id="mobile-menu">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">Home</a></li>
                <li><a href="index.html#about" class="nav-link">Chi Siamo</a></li>
                <li><a href="#" class="nav-link active">Menu</a></li>
                <li><a href="index.html#catering" class="nav-link">Catering</a></li>
                <li><a href="index.html#contact" class="nav-link">Contatti</a></li>
            </ul>
        </div>
    </nav>

    <section class="section" style="padding-bottom: 0;">
        <div class="container">
            <h2 class="section-title fade-in-up">Il Nostro Menu</h2>
            <p style="text-align: center; color: var(--text-muted); max-width: 600px; margin: 0 auto 40px;">
                Scopri le creazioni di Valter e Gianfranco. Ingredienti freschi e aggiornati in tempo reale.
            </p>
        </div>
    </section>

    <section id="menu-list" class="section menu" style="padding-top: 0;">
        <div class="container">
            
            <div class="menu-grid" id="dynamic-menu-container">
                <p style="text-align:center; width:100%; color: var(--text-muted);">Caricamento menu in corso...</p>
            </div>

            <div class="download-section fade-in-up" style="margin-top: 50px;">
                <h3>Vuoi il menu cartaceo?</h3>
                <a href="#" class="btn btn-outline" download>
                    <i class="fa-solid fa-file-pdf"></i> Scarica il Menu in PDF
                </a>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <p>&copy; 2025 Pizza Party di Valter & Gianfranco. Tutti i diritti riservati.</p>
        </div>
    </footer>

    <script src="script.js"></script>

    <script>
        function caricaMenuDaGoogle(json) {
            const container = document.getElementById('dynamic-menu-container');
            container.innerHTML = ''; 
            
            try {
                const rows = json.table.rows;

                if (rows.length === 0) {
                    container.innerHTML = '<p style="text-align:center;">Nessuna pizza trovata.</p>';
                    return;
                }

                rows.forEach((row, index) => {
                    const nome = row.c[0] ? row.c[0].v : null;
                    const descrizione = row.c[1] ? row.c[1].v : '';
                    const prezzo = row.c[2] ? row.c[2].v : '';
                    const specialita = row.c[3] ? row.c[3].v : '';

                    if (!nome) return;

                    let specialBadge = '';
                    if (specialita && ['si', 'sì', 'yes'].includes(String(specialita).toLowerCase().trim())) {
                        specialBadge = `<span style="font-size: 0.8rem; background: var(--primary-color); padding: 2px 8px; border-radius: 10px; color: white; vertical-align: middle; margin-left: 5px;">Specialità</span>`;
                    }

                    let delayClass = '';
                    if (index % 3 === 1) delayClass = 'delay-1';
                    if (index % 3 === 2) delayClass = 'delay-2';

                    const pizzaHTML = `
                        <div class="menu-item fade-in-up ${delayClass}">
                            <div class="menu-details">
                                <h3>${nome} ${specialBadge}</h3>
                                <p>${descrizione}</p>
                            </div>
                            <span class="price">€ ${prezzo}</span>
                        </div>
                    `;
                    container.innerHTML += pizzaHTML;
                });

                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) entry.target.classList.add('visible');
                    });
                }, { threshold: 0.1 });
                document.querySelectorAll('.menu-item').forEach(el => observer.observe(el));

            } catch (err) {
                console.error("Errore lettura dati:", err);
                container.innerHTML = '<p style="text-align:center;">Errore nella lettura del menu.</p>';
            }
        }
    </script>
    
    <script src="https://docs.google.com/spreadsheets/d/1xxI51l8tE7ze5IcA6FbgO1F61qR7INoxRADVpkyD-gE/gviz/tq?tqx=out:json;responseHandler:caricaMenuDaGoogle"></script>

</body>
</html>